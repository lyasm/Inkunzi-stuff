<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Diplomacy Web</title>
	<style>
		#nationDropdown {
			width: 300px;
		}
	</style>
</head>

<body>

	<label for="nationDropdown">Select a Nation:</label>
	<input type="text" id="nationDropdown" oninput="filterNations()" list="nationList" onchange="displayNationDetails()">
	<button onclick="displayNationDetails">Update</button>


	<datalist id="nationList"></datalist>

	<div id="NationDetails"></div>

	<!-- <label for="deepnessDropdown">How deep do you want to go:</label> -->
	<!-- <select id="deepnessDropdown"></select> -->

	<svg width="1960" height="1960"></svg>
	<!-- Load d3.js -->
	<script src="https://d3js.org/d3.v4.min.js"></script>

	<!-- Create a div where the graph will take place -->
	<div id="my_dataviz"></div>


	<script>
		let data;
		// Fetch the JSON data
		fetch('diplo.json')
			.then(response => response.json())
			.then(jsonData => {
				data = jsonData;

				// Get the datalist and populate it with nation names
				const nationList = document.getElementById('nationList');
			// 	data.forEach(entry => {
			// 		const option = document.createElement('option');
			// 		option.value = entry.Nations;
			// 		nationList.appendChild(option);
			// 	});
			    // })
			Object.keys(data).forEach(nationName => {
          const option = document.createElement('option');
          option.value = nationName;
          nationList.appendChild(option);
        });
      })
			.catch(error => console.error('Error loading JSON:', error));

		// Function to filter nations based on user input
		function filterNations() {
			const input = document.getElementById('nationDropdown').value.toLowerCase();
			// const filteredNations = data.filter(entry => entry.Nations.toLowerCase().includes(input));

			// // Update the datalist with filtered nations
			// const nationList = document.getElementById('nationList');
			// nationList.innerHTML = '';
			// filteredNations.forEach(entry => {
			// 	const option = document.createElement('option');
			// 	option.value = entry.Nations;
			// 	nationList.appendChild(option);
		    // });
		const filteredNations = Object.keys(data).filter(nationName => nationName.toLowerCase().includes(input));

      // Update the datalist with filtered nations
      const nationList = document.getElementById('nationList');
      nationList.innerHTML = '';
      filteredNations.forEach(nationName => {
        const option = document.createElement('option');
        option.value = nationName;
        nationList.appendChild(option);
      });
		}

		// Function to display nation details
		function displayNationDetails() {
			const selectedNationName = document.getElementById('nationDropdown').value;
			console.log(selectedNationName);
			const nationDetails = document.getElementById('NationDetails');

			// Find the selected nation in the JSON data
			const selectedNationData = data[selectedNationName];
			console.log(selectedNationData);
			// Display the details in the HTML
			nationDetails.innerHTML = '<pre>' + JSON.stringify(selectedNationData, null, 2) + '</pre>';
		}

	</script>


</body>

</html>
